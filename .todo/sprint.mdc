---
description: 
globs: 
alwaysApply: false
---
# SOL-Bot スプリント

## 🗓 2025-W23 スプリント (6月2日〜6月8日)

- [x] INF-001: テクニカル指標ライブラリのインポートエラー修正
      - 📅 Due        : 2025-06-08
      - 👤 Owner      : @nijor
      - 🏷️  Label      : bug
      - 🩺 Health     : ✅
      - ✎ Notes      : technicalindicatorsライブラリの型定義エラーをsrc/types/technicalindicators.d.tsファイルの作成で解決

## 🗓 2025-W24 スプリント (6月9日〜6月15日)

- [x] DAT-001: 1h 足データ取り込みジョブ
      - 📅 Due        : 2025-06-10
      - 👤 Owner      : @nijor
      - 🔗 Depends-on : INF-001
      - 🏷️  Label      : feat
      - 🩺 Health     : ✅
      - ✎ Notes      : MarketDataFetcherクラスを作成し、ccxtライブラリでデータ取得と保存を実装

- [x] ALG-001: EMA傾き計算の最適化
      - 📅 Due        : 2025-06-15
      - 👤 Owner      : @nijor
      - 🏷️  Label      : feat
      - 🩺 Health     : ✅
      - ✎ Notes      : 線形回帰ベースのスロープ計算に改良し、ボラティリティに応じた動的期間調整を実装

## 🗓 2025-W25〜W26 スプリント (6月16日〜6月29日)

- [x] ALG-002: Donchianブレイクアウト戦略の実装
      - 📅 Due        : 2025-06-20
      - 👤 Owner      : @nijor
      - 🔗 Depends-on : ALG-001
      - 🏷️  Label      : feat
      - 🩺 Health     : ✅
      - ✎ Notes      : Donchianチャネルを使用したブレイクアウト戦略を実装し、ATRベースのストップロス設定を追加

- [x] OMS-001: 注文管理システムの基本実装
      - 📅 Due        : 2025-06-25
      - 👤 Owner      : @nijor
      - 🔗 Depends-on : ALG-002
      - 🏷️  Label      : feat
      - 🩺 Health     : ✅
      - ✎ Notes      : OrderManagementSystemクラスを作成し、注文の作成・管理・ポジション追跡機能を実装

- [x] DOC-001: APIエンドポイントのドキュメント作成
      - 📅 Due        : 2025-06-30
      - 👤 Owner      : @nijor
      - 🏷️  Label      : doc
      - 🩺 Health     : ✅
      - ✎ Notes      : REST APIエンドポイントの詳細な使用方法ドキュメントをsrc/docs/APIEndpoints.mdに作成

- [x] INF-002: index.tsのAPIレスポンス構文エラー修正
      - 📅 Due        : 2025-06-18
      - 👤 Owner      : @nijor
      - 🏷️  Label      : bug
      - 🩺 Health     : ✅
      - ✎ Notes      : res.json({ status:'running', mode:MODE, ...status })の形式を確認し正しく修正

## 🗓 2025-W27〜W28 スプリント (6月30日〜7月13日)

- [x] INF-003: parameters.tsの重複定義解消
      - 📅 Due        : 2025-07-05
      - 👤 Owner      : @nijor
      - 🏷️  Label      : bug
      - 🩺 Health     : ✅
      - ✎ Notes      : index.tsでのMODEの重複定義を解消し、parameters.tsのOPERATION_MODEに統一

- [x] INF-008: Node.js開発環境のセットアップ
      - 📅 Due        : 2025-07-05
      - 👤 Owner      : @nijor
      - 🏷️  Label      : infra
      - 🩺 Health     : ✅
      - ✎ Notes      : tsconfig.jsonを修正し、ccxtとnode-cronの型定義ファイルを作成

- [x] ALG-003: Regime判定ロジックの修正
      - 📅 Due        : 2025-07-05
      - 👤 Owner      : @nijor
      - 🔗 Depends-on : ALG-001
      - 🏷️  Label      : feat
      - 🩺 Health     : ✅
      - ✎ Notes      : LOW_VOL→RangeEngine、HighVol→Trendという分岐を追加し、MarketEnvironmentとrecommendedStrategyに実装

- [x] ALG-004: Trend追従ロジックの改善
      - 📅 Due        : 2025-07-10
      - 👤 Owner      : @nijor
      - 🔗 Depends-on : ALG-002
      - 🏷️  Label      : feat
      - 🩺 Health     : ✅
      - ✎ Notes      : trailingStop = ATR*1.2に変更。add-onポジション（+1Rごとに0.5R）を実装

- [x] ALG-009: rangeStrategy.tsのレンジブレイク時決済方法の改善
      - 📅 Due        : 2025-07-12
      - 👤 Owner      : @nijor
      - 🏷️  Label      : feat
      - 🩺 Health     : ✅
      - ✎ Notes      : VWAPベースの指値注文とIceberg（分割）注文の実装で約定率を向上

## 🗓 2025-W30〜W31 スプリント - 重大リスク修正 (7月22日〜8月4日)

- [x] ALG-012: ブラックスワン検出ロジックの修正
      - 📅 Due        : 2025-07-30
      - 👤 Owner      : @nijor
      - 🏷️  Label      : bug
      - 🩺 Health     : ✅
      - ✎ Notes      : 24時間前の終値（previousDailyClose）を保持し、現在価格との比較で15%変動を検出するよう修正

- [x] ALG-013: リスクフィルターの金額ベース計算への修正
      - 📅 Due        : 2025-07-30
      - 👤 Owner      : @nijor
      - 🏷️  Label      : bug
      - 🩺 Health     : ✅
      - ✎ Notes      : notional = amount × priceを使用してMAX_RISKと比較する実装に変更

- [x] ALG-014: 日次PnL計算の修正
      - 📅 Due        : 2025-07-31
      - 👤 Owner      : @nijor
      - 🏷️  Label      : bug
      - 🩺 Health     : ✅
      - ✎ Notes      : 「午前0時残高」をキャッシュし現在残高との差分で日次PnLを正しく計算

- [x] ALG-015: レジーム判定ロジックの修正
      - 📅 Due        : 2025-08-02
      - 👤 Owner      : @nijor
      - 🏷️  Label      : bug
      - 🩺 Health     : ✅
      - ✎ Notes      : LOW_VOL判定にEMA勾配チェック(0.15°)を追加し、ATR%閾値をパラメータ化

- [x] OMS-003: 成行注文時のpriceパラメータ修正
      - 📅 Due        : 2025-08-04
      - 👤 Owner      : @nijor
      - 🏷️  Label      : bug
      - 🩺 Health     : ✅
      - ✎ Notes      : type===MARKETの場合はpriceパラメータを削除して取引所リジェクトを防止

## 🗓 2025-W32〜W33 スプリント - 機能強化 (8月5日〜8月18日)

- [x] ALG-016: TrailingStopをATR×1.2に変更
      - 📅 Due        : 2025-08-05
      - 👤 Owner      : @nijor
      - 🏷️  Label      : feat
      - 🩺 Health     : ✅
      - ✎ Notes      : 固定3%のトレイリングストップをatr * 1.2の動的な値に変更

- [x] OMS-002: 高度な注文タイプの実装
      - 📅 Due        : 2025-08-08
      - 👤 Owner      : @nijor
      - 🔗 Depends-on : OMS-001
      - 🏷️  Label      : feat
      - 🩺 Health     : ✅
      - ✎ Notes      : Post-Only + Hidden Iceberg / OCOをccxtで実装。発注オプションに追加

- [x] ALG-017: 動的グリッド本数計算にATR%反映
      - 📅 Due        : 2025-08-10
      - 👤 Owner      : @nijor
      - 🏷️  Label      : feat
      - 🩺 Health     : ✅
      - ✎ Notes      : レンジ幅とATR%に基づいてceil(range/(ATR*0.6))でグリッド本数を動的計算

- [x] OMS-004: Post-Only & Icebergオプション実装
      - 📅 Due        : 2025-08-15
      - 👤 Owner      : @nijor
      - 🔗 Depends-on : OMS-002
      - 🏷️  Label      : feat
      - 🩺 Health     : ✅
      - ✎ Notes      : CCXT発注時に{ postOnly:true, iceberg:qty }オプションを追加、決済ペアはcreateOcoOrder

- [x] ALG-018: ポジション偏りヘッジ実装
      - 📅 Due        : 2025-08-18
      - 👤 Owner      : @nijor
      - 🏷️  Label      : feat
      - 🩺 Health     : ✅
      - ✎ Notes      : NetPositionDeltaが15%を超えた場合にVWAP成行でヘッジするロジックを実装

## 🗓 2025-W34〜W35 スプリント - P0バグ修正 (8月19日〜9月1日)

- [x] OMS-005: STOP_MARKET注文のpriceパラメータ修正
      - 📅 Due        : 2025-08-25
      - 👤 Owner      : @nijor
      - 🏷️  Label      : bug
      - 🩺 Health     : ✅
      - ✎ Notes      : type.endsWith('MARKET')の条件判定で成行系すべてのpriceをundefinedに修正

- [x] INF-011: HTTP 429エラー時の指数バックオフ実装
      - 📅 Due        : 2025-08-28
      - 👤 Owner      : @nijor
      - 🏷️  Label      : bug
      - 🩺 Health     : ✅
      - ✎ Notes      : enableRateLimit:trueのみでは不十分。for (retry of [1,2,4,8,16])の指数バックオフ実装

- [x] OMS-006: 注文ステータス更新プロセスの修正
      - 📅 Due        : 2025-08-30
      - 👤 Owner      : @assistant
      - 🏷️  Label      : bug
      - 🩺 Health     : ✅
      - ✎ Notes      : 取引所送信成功後、ステータスをOPEN→PLACEDに、約定webhook受信時にFILLEDへ更新

## 🗓 2025-W36〜W37 スプリント - P1設計改善 (9月2日〜9月15日)

- [x] CONF-004: ATR%閾値の外部設定化
      - 📅 Due        : 2025-09-05
      - 👤 Owner      : @nijor
      - 🏷️  Label      : feat
      - 🩺 Health     : ✅
      - ✎ Notes      : ATR%閾値(6.0%)をprocess.env.ATR_PERCENTAGE_THRESHOLDで外部化、node-env.d.tsにも追加

- [x] ALG-020: EMA傾き計算のタイムフレーム対応
      - 📅 Due        : 2025-09-10
      - 👤 Owner      : @nijor
      - 🏷️  Label      : bug
      - 🩺 Health     : ✅
      - ✎ Notes      : 4h足前提から一般化：factor = (365*24/timeframeHours)/(periods/6)に修正

- [x] ALG-021: レンジ戦略のグリッド本数計算修正
      - 📅 Due        : 2025-09-15
      - 👤 Owner      : @nijor
      - 🏷️  Label      : bug
      - 🩺 Health     : ✅
      - ✎ Notes      : atrPercentageは%表記(100倍)のため、0.006にしてグリッド本数を適正化

- [x] ALG-019: ATR配列不足時のセーフガード
      - 📅 Due        : 2025-09-01
      - 👤 Owner      : @nijor
      - 🏷️  Label      : bug
      - 🩺 Health     : ✅
      - ✎ Notes      : marketState.ts行42付近でatrValues.length確認、空の場合はUNKNOWN環境を返す

## 🗓 完了したタスク

- [x] INF-002: プロジェクトのフォルダ構造設定
      - 📅 Due        : 2025-06-01
      - 👤 Owner      : @nijor
      - 🏷️  Label      : infra
      - 🩺 Health     : ✅
      - ✎ Notes      : SOL-Botのプロジェクト構造を整備し、必要なフォルダを作成

- [x] ALG-006: Black-Swanリスク対策の実装
      - 📅 Due        : 2025-07-20
      - 👤 Owner      : @nijor
      - 🏷️  Label      : feat
      - 🩺 Health     : ✅
      - ✎ Notes      : if(abs(price-prevClose)/prevClose > 0.15)でexecuteEmergencyStrategy()を強制呼び出し

- [x] ALG-010: リスクフィルターのSELL注文対応追加
      - 📅 Due        : 2025-08-25
      - 👤 Owner      : @nijor
      - 🏷️  Label      : bug
      - 🩺 Health     : ✅
      - ✎ Notes      : SELLサイドはposition.size or marginAvailableを考慮するように修正

- [x] ALG-005: Range/グリッド戦略の動的調整
      - 📅 Due        : 2025-07-15
      - 👤 Owner      : @nijor
      - 🏷️  Label      : feat 
      - 🩺 Health     : ✅
      - ✎ Notes      : ATR%を受け取りlevels = ceil(range/(ATR*0.6))へ置換。GRID_PERCENTAGEを削除して動的計算に変更

- [x] ALG-008: trendStrategy.tsのHighest/Lowest計算修正
      - 📅 Due        : 2025-08-15
      - 👤 Owner      : @nijor
      - 🏷️  Label      : bug
      - 🩺 Health     : ✅
      - ✎ Notes      : Highest.calculate関数に正しくperiodを使用するよう修正し、コメントを追加

- [x] ALG-007: ポジションサイズ計算ロジックの改善
      - 📅 Due        : 2025-07-30
      - 👤 Owner      : @nijor
      - 🏷️  Label      : feat
      - 🩺 Health     : ✅
      - ✎ Notes      : riskAmount = balance * MAX_RISK_PER_TRADE → positionSize = riskAmount/stopDistanceへ変更






















































