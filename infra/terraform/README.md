# SOL-Bot インフラストラクチャ・アズ・コード（IaC）

このディレクトリには、SOL-Botのインフラストラクチャをコード化したTerraformファイルが含まれています。

## ディレクトリ構造

```
terraform/
  ├── staging/           # ステージング環境用のTerraformコード
  │   ├── main.tf        # 主要なリソース定義
  │   ├── variables.tf   # 変数定義
  │   ├── outputs.tf     # 出力値定義
  │   ├── terraform.tfvars.example  # 変数設定例
  │   └── README.md      # ステージング環境用のドキュメント
  └── production/        # 本番環境用のTerraformコード（今後追加予定）
```

## 環境構成

### ステージング環境

- **目的**: 開発したコードのテストと検証
- **構成**: 単一EC2インスタンス（t3.small）、ElasticIP、セキュリティグループ、IAMロール
- **詳細**: `staging/README.md` を参照

### 本番環境（計画中）

- **目的**: 実際のトレーディングボットの運用
- **構成**: 複数のEC2インスタンス、Blue/Green デプロイ構成、高可用性設計
- **詳細**: 今後追加予定

## 全体的な実行手順

### 1. 環境の選択

実行するTerraformコードのディレクトリに移動します：

```bash
cd staging  # ステージング環境の場合
```

### 2. 環境固有のセットアップ

各環境ディレクトリ内のREADMEファイルに従って、環境固有のセットアップを行います。

### 3. 共通のコマンド

各環境共通で使用する基本的なTerraformコマンド：

```bash
# 初期化
terraform init

# 実行計画の確認
terraform plan

# リソースの作成/更新
terraform apply

# リソースの削除
terraform destroy
```

## セキュリティに関する注意

- 重要な認証情報（AWSアクセスキーなど）はGitリポジトリにコミットしないでください。
- `terraform.tfvars` ファイルは `.gitignore` に追加されています。
- 本番環境では、セキュリティグループの設定を厳密に行い、必要最小限のポートのみを公開してください。

## 継続的インテグレーション

- Terraformコードの変更は、PRを通じて行い、レビューを経て承認されるようにしてください。
- GitHubワークフローで `terraform plan` を実行し、変更内容を確認できるようにしています。

## コントリビューション

新しい環境の追加や既存環境の改善を行う場合は、以下の点に注意してください：

1. 既存の命名規則に従う
2. 変数を適切に使用し、ハードコードを避ける
3. コードにコメントを追加し、複雑な部分を説明する
4. READMEを更新して、変更点や新しい機能を文書化する 